# Identify dates, so they can be converted to a different format without errors
# method: count the number of null rows per column before, force date converstion (null if they fail to convert), then compare number of nulls afterwards
# if the number of nulls match, and the starting number >0 then all rows converted without error. List these columns as date columns

def identify_dates(your_dataframe):

  date_column_list = []
  test_df = your_dataframe.copy() # make a copy so the original isnt affected

  # Loop through columns and force convert to datetime
  for column in test_df.columns:
    non_null_before = test_df[column].count()  # non null count before
    test_df[column] = pandas.to_datetime(test_df[column], errors='cooerce')  # force date format, will be null if fails (NAT)
    non_null_after = test_df[column].count()  # non null count after

    # add date columns to the list (>0 so all null columns arent listed as date format)
    if non_null_before >0 and non_null_before = non_null_after:
      date_column_list.append(column)
      print(f"date column found: {column}")

  return date_column_list
